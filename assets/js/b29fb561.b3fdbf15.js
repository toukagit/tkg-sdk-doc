"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[7335],{3905:(e,t,n)=>{n.d(t,{Zo:()=>o,kt:()=>m});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var c=a.createContext({}),u=function(e){var t=a.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},o=function(e){var t=u(e.components);return a.createElement(c.Provider,{value:t},e.children)},d="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},k=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,l=e.originalType,c=e.parentName,o=s(e,["components","mdxType","originalType","parentName"]),d=u(n),k=r,m=d["".concat(c,".").concat(k)]||d[k]||p[k]||l;return n?a.createElement(m,i(i({ref:t},o),{},{components:n})):a.createElement(m,i({ref:t},o))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=n.length,i=new Array(l);i[0]=k;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s[d]="string"==typeof e?e:r,i[1]=s;for(var u=2;u<l;u++)i[u]=n[u];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}k.displayName="MDXCreateElement"},6448:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>i,default:()=>p,frontMatter:()=>l,metadata:()=>s,toc:()=>u});var a=n(7462),r=(n(7294),n(3905));const l={sidebar_position:7},i="In App Purchase",s={unversionedId:"tkg-integration/sdk-basic/sdk-func-iap",id:"version-3.0.x/tkg-integration/sdk-basic/sdk-func-iap",title:"In App Purchase",description:"- Add USE_IAP macro definition",source:"@site/i18n/en/docusaurus-plugin-content-docs/version-3.0.x/tkg-integration/sdk-basic/sdk-func-iap.md",sourceDirName:"tkg-integration/sdk-basic",slug:"/tkg-integration/sdk-basic/sdk-func-iap",permalink:"/tkg-sdk-doc/3.0.x/tkg-integration/sdk-basic/sdk-func-iap",tags:[],version:"3.0.x",sidebarPosition:7,frontMatter:{sidebar_position:7},sidebar:"tutorialSidebar",previous:{title:"Event Tracking",permalink:"/tkg-sdk-doc/3.0.x/tkg-integration/sdk-basic/sdk-func-event"},next:{title:"Account system",permalink:"/tkg-sdk-doc/3.0.x/tkg-integration/sdk-basic/sdk-func-account"}},c={},u=[{value:"In App Purchase access method",id:"in-app-purchase-access-method",level:2},{value:"1 Add macro definition",id:"1-add-macro-definition",level:3},{value:"2 Add the item ID",id:"2-add-the-item-id",level:3},{value:"3 Add Purchase callback",id:"3-add-purchase-callback",level:3},{value:"4 In App Purchase interface",id:"4-in-app-purchase-interface",level:3},{value:"In App Purchase event",id:"in-app-purchase-event",level:2},{value:"In-purchase button display",id:"in-purchase-button-display",level:3},{value:"In-purchase button click",id:"in-purchase-button-click",level:3},{value:"First purchase success",id:"first-purchase-success",level:3},{value:"Successful purchase",id:"successful-purchase",level:3}],o={toc:u},d="wrapper";function p(e){let{components:t,...n}=e;return(0,r.kt)(d,(0,a.Z)({},o,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"in-app-purchase"},"In App Purchase"),(0,r.kt)("div",{className:"admonition admonition-danger alert alert--danger"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"danger")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("ul",{parentName:"div"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Add USE_IAP macro definition"),"   "),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Unity In App Purchasing plug-in version 4.4.0 or later"),"   "),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"If a Unity Gaming Services component is used in your project, ensure that it is manually initialized and that the SDK initialization method is executed in the Unity Gaming Services component initialization success callback"))))),(0,r.kt)("h2",{id:"in-app-purchase-access-method"},"In App Purchase access method"),(0,r.kt)("h3",{id:"1-add-macro-definition"},"1 Add macro definition"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-c"},"USE_IAP \n")),(0,r.kt)("h3",{id:"2-add-the-item-id"},"2 Add the item ID"),(0,r.kt)("p",null,"Add the item ID to the IAPProducts.cs file."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-c"},'public const string NoAds = "test.tremoveads";\n\npublic static readonly Dictionary<string, ProductType> ProductDic = new Dictionary<string, ProductType>()\n{\n    // ProductType.NonConsumable  only buy once. Good for one-time purchases, such as extra levels\n    // ProductType.Consumable     can be purchased repeatedly. Suitable for consumable goods such as virtual currency\n    // ProductType.Subscription   can be purchased and restored repeatedly. Durable goods, but for a limited period (subscription)\n\n    { NoAds, ProductType.NonConsumable}\n        \n};\n')),(0,r.kt)("h3",{id:"3-add-purchase-callback"},"3 Add Purchase callback"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-c"},"\nIAPTool.Instance.OnPurchaseDone += OnPurchaseResult;\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-c"},"private void OnPurchaseResult(string pID, bool pResult)\n{\n    if (pID.Equals(IAPProducts.NoAds) && pResult)\n    {\n        // After successful purchase, remove advertising\n        TKGSDKManager.Instance.IsRemoveAds = true;\n    }\n}\n")),(0,r.kt)("h3",{id:"4-in-app-purchase-interface"},"4 In App Purchase interface"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-c"},"IAPTool.Instance.BuyProductByID(IAPProducts.NoAds);\n")),(0,r.kt)("h2",{id:"in-app-purchase-event"},"In App Purchase event"),(0,r.kt)("h3",{id:"in-purchase-button-display"},"In-purchase button display"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"}," void LogIAPBtnShow(string _iap, string _id, string _currency, string _price) ")),(0,r.kt)("table",null,(0,r.kt)("tr",null,(0,r.kt)("td",null,"Name"),(0,r.kt)("td",null,"isRequired"),(0,r.kt)("td",null,"Type"),(0,r.kt)("td",null,"Description")),(0,r.kt)("tr",null,(0,r.kt)("td",null,"iap"),(0,r.kt)("td",null,"Y"),(0,r.kt)("td",null,"string"),(0,r.kt)("td",null,"Custom product name on the game side")),(0,r.kt)("tr",null,(0,r.kt)("td",null,"id"),(0,r.kt)("td",null,"Y"),(0,r.kt)("td",null,"string"),(0,r.kt)("td",null,"Product ID",(0,r.kt)("br",null),"GP\uff1aProductID",(0,r.kt)("br",null),"iOS\uff1aSKU")),(0,r.kt)("tr",null,(0,r.kt)("td",null,"currency"),(0,r.kt)("td",null,"Y"),(0,r.kt)("td",null,"string"),(0,r.kt)("td",null,"A monetary unit, such as USD")),(0,r.kt)("tr",null,(0,r.kt)("td",null,"price"),(0,r.kt)("td",null,"Y"),(0,r.kt)("td",null,"string"),(0,r.kt)("td",null,"Purchase price"))),(0,r.kt)("p",null,"Call ",(0,r.kt)("inlineCode",{parentName:"p"},"LogIAPBtnShow")," method when the in-app purchase button is displayed."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-c"},'TKGSDKManager.Instance.LogIAPBtnShow("200Diamond","com.game.diamond200","USD","1.99");\n')),(0,r.kt)("hr",null),(0,r.kt)("h3",{id:"in-purchase-button-click"},"In-purchase button click"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"}," void LogIAPBtnClick(string _iap, string _id, string _currency, string _price) (parameters are the same as above)")),(0,r.kt)("p",null,"Call ",(0,r.kt)("inlineCode",{parentName:"p"},"LogIAPBtnClick")," method when the in-app purchase button is clicked."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-c"},'TKGSDKManager.Instance.LogIAPBtnClick("200Diamond","com.game.diamond200","USD","1.99");\n')),(0,r.kt)("hr",null),(0,r.kt)("h3",{id:"first-purchase-success"},"First purchase success"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"}," void LogIAPFirstPurchase(string _iap, string _id, string _currency, string _price) (parameters are the same as above)")),(0,r.kt)("p",null,"Call ",(0,r.kt)("inlineCode",{parentName:"p"},"LogIAPFirstPurchase")," method when first successful purchase."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-c"},'TKGSDKManager.Instance.LogIAPFirstPurchase("200Diamond","com.game.diamond200","USD","1.99");\n')),(0,r.kt)("hr",null),(0,r.kt)("h3",{id:"successful-purchase"},"Successful purchase"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"}," void LogIAPSuccess(string _iap, string _id, string _gameOrderid, string _paymentChannelOrderid, string _productToken, string _paymentMethod, string _currency, string _price) ")),(0,r.kt)("table",null,(0,r.kt)("tr",null,(0,r.kt)("td",null,"Name"),(0,r.kt)("td",null,"isRequired"),(0,r.kt)("td",null,"Type"),(0,r.kt)("td",null,"Description")),(0,r.kt)("tr",null,(0,r.kt)("td",null,"iap"),(0,r.kt)("td",null,"Y"),(0,r.kt)("td",null,"string"),(0,r.kt)("td",null,"Custom product name on the game side")),(0,r.kt)("tr",null,(0,r.kt)("td",null,"id"),(0,r.kt)("td",null,"Y"),(0,r.kt)("td",null,"string"),(0,r.kt)("td",null,"Product ID",(0,r.kt)("br",null),"GooglePlay\uff1aProductID",(0,r.kt)("br",null),"iOS\uff1aSKU")),(0,r.kt)("tr",null,(0,r.kt)("td",null,"gameOrderid"),(0,r.kt)("td",null,"Y"),(0,r.kt)("td",null,"string"),(0,r.kt)("td",null,'The order id on the game side. (Pass "" if unavailable)')),(0,r.kt)("tr",null,(0,r.kt)("td",null,"paymentChannelOrderid"),(0,r.kt)("td",null,"Y"),(0,r.kt)("td",null,"string"),(0,r.kt)("td",null,"Financial transactions on GooglePlay/ iOS. Whenever a financial transaction occurs, the system creates an order ID. The value of orderId retrieved from the ProcessPurchase(PurchaseEventArgs e) method in the IAPTool.cs file.")),(0,r.kt)("tr",null,(0,r.kt)("td",null,"productToken"),(0,r.kt)("td",null,"Y"),(0,r.kt)("td",null,"string"),(0,r.kt)("td",null,"When a purchase is successful on GooglePlay, a purchase token is generated as a unique identifier, and other payment methods can be passed blank. The value of purchaseToken retrieved from the ProcessPurchase(PurchaseEventArgs e) method in the IAPTool.cs file.")),(0,r.kt)("tr",null,(0,r.kt)("td",null,"paymentMethod"),(0,r.kt)("td",null,"Y"),(0,r.kt)("td",null,"string"),(0,r.kt)("td",null,"Official payment channels: AppStore, GooglePlay, other payment channels to send the corresponding channel name")),(0,r.kt)("tr",null,(0,r.kt)("td",null,"currency"),(0,r.kt)("td",null,"Y"),(0,r.kt)("td",null,"string"),(0,r.kt)("td",null,"A monetary unit, such as USD")),(0,r.kt)("tr",null,(0,r.kt)("td",null,"price"),(0,r.kt)("td",null,"Y"),(0,r.kt)("td",null,"string"),(0,r.kt)("td",null,"Purchase price"))),(0,r.kt)("p",null,"Call ",(0,r.kt)("inlineCode",{parentName:"p"},"LogIAPSuccess")," method when the successful purchase."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-c"},'TKGSDKManager.Instance.LogIAPSuccess("200Diamond","com.game.diamond200","game-20230712035656546","GPA.3327-1005-9772-34199","fhlkemmlgnoaedkjmlobdkce.AO-J1OxTtpuomZK4pjutaKDyOqQfFBF122_NgIlMzU_3xrYdvvv9ed1Y-WZVC7yXBVQDKKjx25rs8S02mHjE9GUmfhXbDT_TIyYHQCEyJbTmdnS82N5FR4o","GooglePlay","USD","1.99");\n')),(0,r.kt)("hr",null))}p.isMDXComponent=!0}}]);